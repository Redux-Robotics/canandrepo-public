# 2026.0.0-beta1

## New Features
* Completely open source
* Completely rewritten driver backend
* Preliminary SocketCan support

## Breaking API changes
* [General] Drop arm32 support
* [Canandgyro] setYaw and setPose now have retries.

# 2025.0.2

## Bug fixes
* [Canandcolor] Fix DigoutChannel.configureFrameTrigger not working as expected
* [Canandcolor] Fix RGBDigoutConfig incorrectly setting blue threshold 
* [Canandcolor] Fix DigoutChannel.configureSlots() returning false even when configuration succeeded.
* [C++] Fix settings sets failing
* [C++] Enable CAN device disconnection warnings by default
* [Canandgyro] Fix CanandgyroSettings.allSettingsReceived() incorrectly returning false
* [ReduxCore] Fix std::terminate crashes on process exit

# 2025.0.1

This release fixes C++ bugs.

## Bug fixes
* [C++] Fix Canandgyro yaw read

# 2025.0.0

This release is identical to v2025.0.0-beta2, but built against WPILib v2025.1.1

# 2025.0.0-beta2

This release is built against WPILib v2025.1.1-beta3.

It introduces Canandcolor support.

As WPILib had some C++ ABI changes involving Canandgyro-related classes, this version is required if you wish to use ReduxLib with WPILib v2025.1.1-beta2+.

## New Features
* [Java] Canandcolor support

## Breaking API changes
* [Java] Split inner faults/settings classes from the enclosing object class.

## Bug fixes
* [C++] Fix Windows desktop simulation
* [C++] Move to a shared config for ReduxLib C++
* [Java/C++] Various doc fixes

# 2025.0.0-beta0

This release is identical to v2024.3.2 with the patches required to **build** against WPILib v2025.1.1-beta1.

It should function identically but breakage may still happen; use at your own risk.

# 2024.3.2

This release adds support for WPILib struct serialization for a few classes.

## New Features
* [Java/C++] wpistruct support for Canandgyro and Canandmag status and faults classes
 * C++ also gets support for angular velocity and acceleration data classes
* [Java/C++] New `getStatus` allows for fetching of `Canandgyro.Status` and `Canandmag.Status` objects directly
* [Java] `faultBitfield()` method for faults classes, for those who prefer bit flags
* [Java] Javadoc syntax highlighting and quality improvements

## Bug fixes
* [Java] Add `getStatusFrame()` for Canandgyro and Canandmag

## Known issues
* 2024 versions of Glass and other utilities may not unpack nested wpistruct schemas correctly; 2025 versions of wpilib tools will hopefully fix this

# 2024.3.1

We are proud to present the first release with Canandgyro support. 

**This requires WPILib version 2024.3.2.** If you have compilation issues with C++, make sure to update WPILib in your robot project!

This is also paired with a new v2024.2.0 firmware release for Canandmags being used over CAN. **You must update your Canandmag to v2024.2.0 for it to work properly with this vendordep!**

## New Features
* [Java/C++] **add Canandgyro support**
* [Driver] New, faster OTA algorithm
* [Java] Added `Frame.hasData()` as part of the abstract `Frame` class definition

## API changes
* [Java/C++] Slight change to definition of CAN id layout
* [Java/C++] Reduce default settings timeouts to 20 ms across the board
* [Java] Frame callbacks now call on the Frame object itself rather than the FrameData as the argument
* [Java] `Settings` objects now return `java.util.Optional` instead of null on the getters.
* [Java] CanandDeviceDetails uses a different set of autogenerated definitions

## Bug fixes
* [Java] Fix AdvantageKit messing with `Timer.getFPGATimestamp()`
* [Java/C++] Fix settings operations timing out when they shouldn't
* [Java/C++] Fix isConnected() functionality
* [Java] Fix `Frame.removeCallback`
* [Java] Tweaks across the board to reduce object allocation
* [Driver] Fix Windows MSVC support

# 2024.2.0

## API changes
* [Java/C++] Branding updates

## Bug fixes
* [Driver] Increase robustness to HAL_CAN_OpenStreamSession not succeeding immidiately

# 2024.1.2

## Bug fixes
* [Java] Fix an NPE in the firmware version checker

# 2024.1.1

This is the official 2024 season release.

## API changes
* [Java] Move ReduxJNI to the `canand` package to remove some low-level footguns
* [Driver] CAN message event loops now run as RT threads.

# 2024.1.1-beta0

## New Features
* Introduced firmware version checking on device instantiation, which produces errors on out-of-date firmware.
* Errors/warnings are also logged for disconnected CAN devices. 
* `Canandmag.setSettings()` and `Canandcolor.setSettings()` now retry on failed settings by default, and the most commonly-used overloads now report errors to the driver station on failure.
* Ephemeral settings writes are now supported in many places, allowing for changing device configuration without wearing down flash.

## Notable Breaking Changes
* This is a 2024 beta. It will not run on 2023.
* `Canandmag.getSettings()` and `Canandcolor.getSettings()` **no longer return null/nullopt!** To check success, use **allSettingsReceived** (e.g. `Canandmag.Settings.allSettingsReceived()`)
* Many settings, faults and status classes are now inner classes of their associated object in Java.
 * Basically, one writes `Canandmag.Settings` instead of `CanandmagSettings`. 
* `Canandmag.isPresent` and `Canandcolor.isPresent` have been renamed to `isConnected` and moved to `CanandDevice` (for consistency with WPILib's similar function)
* New overloads for `.getSettings()` and `.setSettings()` have been added to acccomodate retries. 
* In C++, the original function signatures have been changed, in particular the return type of `.setSettings()`.
* The vendordep now sends 8-byte settings sets. **Canandmags with firmwares older than v2024.1.0 will need a firwmare update for settings to work correctly.** -- This is especially important for the original pre-October run (green Canandmags), as settings will not set at all for their factory-flashed firmware.
* The Canandcolor API in general had large revisions from the preview in v2023.2.0.

## Bug fixes
* [Java/C++] All code in Javadoc/Doxygen should actually compile now due to automated validation. Previously, most sample code in the docs didn't. Oops.
* [Java/C++] HAL device usage reporting now uses the correct Redux-specific IDs :')
* [Java/C++] More documentation tweaks overall. Sample code has been folded to fit better on narrower screens.

## API changes
* [Java] `CanandAddress` now has getters for the device type, product class, and device id
* [Java/C++] lastMessageTs has been moved to `CanandDevice` as part of the `isConnected` refactor
* [Java/C++] Introduce `CanandDevice.preHandleMessage` -- a function called before `handleMessage` to handle common logic such as settings receives and last message timing. 
* [Java/C++] Remove `CanandDevice.handleSettingRecv` as it's now part of `preHandleMessage`
* [Java/C++] Introduce `CanandDevice.checkReceivedFirmwareVersion` and  `CanandDevice.getMinimumFirmwareVersion()`
* [Java/C++] The Canandmag zero offset is now directly settable with `Canandmag.Settings.setZeroOffset`
* [C++] `SetSettings` now returns a `CanandSettings` of failed settings sets rather than a boolean.

## Canandcolor-specific changes

* [Java/C++] Rename `CanandcolorDigoutState` to `CanandcolorDigoutSlotState` due to addition of PWM outputs
* [Java/C++] Rename `sat()` in `CanandcolorColor` to `saturation()`
* [C++] Fix incorrect device class in constructor
* [C++] Fix incorrect ordering of `SlotComparison` index values
* [Java] Fix NullPointerException with setDigoutSlot 
* [Java] Use the faster FPGA timer rather than `System.nanoTime`
* [Java/C++] Move all the nested classes in `CanandcolorDigoutSlot` to their own subpackage
* [Java/C++] Add support for HSV/normalized diff data sources and PWM output configuration for digouts. As a result, `CanandcolorSettings.setDigoutPinNormallyClosed` has been replaced with `CanandcolorSettings.setDigoutOutputMode` and `CanandcolorDigoutMode`
* [Java/C++] Digout slots also support XOR joins
* [Java/C++] `CanandcolorDigoutSlot` and `CanandcolorDigoutMode` now uses the sealed interface/implementing record pattern in Java and std::variant in C++ to emulate the Rust enum pattern.
* [Java/C++] Add `setLampLEDBrightness` to manipulate the lamp LED's brightness.


# 2023.2.0

## Notable Breaking Changes
* All instances of "CANand" have been changed to "Canand" for consistency with everything that's not ReduxLib. Our apologies for the breakage this will cause.
 * Switching current code should be as simple as using the VSCode search and replace to change "CANand" (with Match Case selected) with "Canand"

## New Features
* Canandcolor CAN color/proximity sensor suppport added
* CAN timestamps now use FPGA time rather than CLOCK_MONOTONIC
* Open-source section of the vendordep is now public (and accepts issues) at https://github.com/Redux-Robotics/ReduxLib-public
* Linux arm32/arm64 standalone is now supported

## Bug fixes
* [Java] Fix hang on sim exit due to unterminated CanandEventLoop
* [Java] Fix crashes due to mutation of the listener list with CanandEventLoop
* [Java] Removed heap allocations from handleMessage() updates to reduce GC load
* [Java] CanandUtils.bytesToLong(byte[] data) now actually works
* [C++] Fix C++ crash on simulation init due to uninitialized HAL
* [Java/C++] Blocking settings operations reworked to be thread safe
* [Java/C++] Use the FPGA timestamp for all timediffs internally (it's faster than the standard CLOCK_MONOTONIC for 2024)
* [Java/C++] CAN timestamps are now relative to the FPGA timestamp rather than CLOCK_MONOTONIC
* [Java/C++] Various doc comment fixes

## API changes
* [Java] CAN/Setting/Setting command constants are now in ``Details``-type classes, similar to the details namespace in C++
* [Java] Frames have been reworked to avoid heap (de)allocation on update -- the base class is abstract and implementing classes are backed by a primitive (or array of primitives)
* [Java] CanandMessage now has a copy constructor and is mutable to avoid heap allocation
* [C++] Source files have been internally reorganized -- side classes for devices are now distributed in different headers that the main device header imports
* [C++] Canandmag::kCountsPerRotation and Canandmag::kCountsPerRotationPerSecond are now public
* [Java/C++] Constants are changed to fit the WPILib Hungarian notation
* [Java/C++] Support for the FETCH_SETTING_VALUE setting command has been added
* [Java/C++] ReduxCore version is now checked
* [Core] ReduxCore_WaitForCANMessage now returns an int (-1 means CANLink is exiting)
* [Core] ReduxCore_GetVersion now exists
* [Core] ReduxCore_CANMessage has been rearranged to account for 64-bit microsecond-resolution timestamps, and all timestamps are retimed to the FPGA timestamp


# 2023.1.0
Initial release 